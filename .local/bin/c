#!/usr/bin/env bash

if [ "$1" = "run" ] ; then
  DEBUG=false
  RUN=true
  FILENAME=$2
elif [ "$1" = "debug" ] ; then
  DEBUG=true
  RUN=false
  FILENAME=$2
else
  DEBUG=false
  RUN=false
  FILENAME=$1
fi

FILENAME=${FILENAME:-main}
FILES=$(ls *.c)

if $DEBUG ; then
  cc -std=c99 -Wall -Wextra -Werror -g -o $FILENAME $FILES
  STATUS="$?"
  if [ $STATUS -ne 0 ] ; then
    exit
  fi
  gdb $FILENAME
else 
  cc -std=c99 -Wall -Wextra -Werror -o $FILENAME $FILES
  STATUS="$?"
fi

if [ $STATUS -ne 0 ] ; then
  exit
fi

if $RUN ; then
  ./$FILENAME
fi
